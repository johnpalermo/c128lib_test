#import "common/lib/common-global.asm"
#import "framework/lib/string-global.asm"


//BasicUpstart2(start)  // 10 sys$0810
c128lib_BasicUpstart128(start)


string1: 
    .text "QNBTIDAFMHEKJUYZLCXRGVOSWPQNTXEDJHAKGYBVFLUIPSORCZMWNQMUBTVEFISLJKHYRDAGXCPWOZNSQEJITMFLHVKUWERDSDFS"
    .text "QNBTIDAFMHEKJUYZLCXRGVOSWPQNTXEDJHAKGYBVFLUIPSORCZMWNQMUBTVEFISLJKHYRDAGXCPWOZNSQEJITMFLHVKUWERDSDFS"
    .text "QNBTIDAFMHEKJUYZLCXRGVOSWPQNTXEDJHAKGYBVFLUIPSORC HELLO! TVEFISLJKHYRDAGXCPWOZNSQEJITMFLHVKUWERDSDFS"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string2: 
    .text "QNBTIDAFMHEKJUYZLCXRGVOSWPQNTXEDJHAKGYBVFLUIPSORCZMWNQMUBTVEFISLJKHYRDAGXCPWOZNSQEJITMFLHVKUWERDSDFS"
    .text "QNBTIDAFMHEKJUYZLCXRGVOSWPQNTXEDJHAKGYBVFLUIPSORCZMWNQMUBTVEFISLJKHYRDAGXCPWOZNSQEJITMFLHVKUWERDSDFS"
    .text "QNBTIDAFMHEKJUYZLCXRGVOSWPQNTXEDJHAKGYBVFLUIPSORC HELLO! TVEFISLJKHYRDAGXCPWOZNSQEJITMFLHVKUWERDSDFS"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string3:
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string4:
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string5:
    .text "MY NAME IS JOHN  01234567890123456789012345678901234567890123456789012345678901234567890123456789012"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "012345678901234567890123456789012345678901234567 PALERMO 5678901234567890123456789012345678901234567"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string6:
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string7:
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string8:
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string9:
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string10:
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string11: 
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string12: 
    .text "ONE DAY A PERSON CAME TO ME AND SAID I WAS A GOOD BOY 1234567890123456789012345678901234567890123459"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "012345678901234567890123456789012 THAT IS PRETTY COOL S 67890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string13: 
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901TOP THE MUSIC"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string14: 
    .text "ONE DAY A PERSON CAME TO ME AND SAID I WAS A GOOD BOY 1234567890123456789012345678901234567890123459"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "012345678901234567890123456789012 THAT IS PRETTY COOL S 67890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
string15: 
    .text "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"
    .text "0123456789012345678901234567890123456789012345678901TOP THE MUSIC"
    .byte 0,0,0,0,0,0,0,0,0,0,0,0
length:
    .byte 0
num_chars:
    .byte 0
start_pos:
    .byte 0


start:
    lda #<string1
    sta c128lib.String.ZP_SRC
    lda #>string1
    sta c128lib.String.ZP_SRC+1

    lda #<string2
    sta c128lib.String.ZP_TRG
    lda #>string2
    sta c128lib.String.ZP_TRG+1

// -----------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------
.break
string_compare_test1:   
    ldy #0
/*
  Preconditions:
    1) string1Address, string2Address must be a 16-bit address or 8-bit zero-page address
       holding the address of the string
    2) Zero-page address must not be greater than $FE, or error
*/
    // Y=0
    // Z=0,C=0
    @c128lib_StringCompare(string1,string2,false)
/*
  Postconditions: 
    1) The zero flag is set if the strings are identical and cleared otherwise.
       In either case, the carry flag is cleared
    2) If both strings are equal up to 256 bytes, and no terminator is found then the carry 
       flag and zero flag are set; otherwise they are both cleared
    3) When substrings of the 2 strings are equal, starting from the beginning, the Y register
       will contain the index of the end of the substrings.
    4) If the strings are equal, the Y register will contain their lengths. 
    5) The contents at string1Address and string2Address are left unchanged.
*/
    // Y=0
    // Z=1,C=1
// -----------------------------------------------------------------------------------------------------
.break
string_compare_test2:   
    ldy #0 //clear Y
    lda #1 //clear Z flag
    clc
    // Y=0
    // Z=0,C=0
    @c128lib_StringCompare(c128lib.String.ZP_SRC,c128lib.String.ZP_TRG,false)
    // Y=0
    // Z=1,C=1
// -----------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------
string_length_test1:
    ldy #0 //clear Y
    lda #1 //clear Z flag
    clc
    // Y=0
    // Z=0,C=0
    // length= garbage
    @c128lib_StringLength(string1,false)
    sty length
    // Y=0
    // Z=1,C=1
    // length=0
// -----------------------------------------------------------------------------------------------------
string_length_test2:
    ldy #0 //clear Y
    lda #1 //clear Z flag
    clc
    sty length //clear length
    // Y=0
    // Z=0,C=0
    // length= garbage
    @c128lib_StringLength(c128lib.String.ZP_SRC,false)
    sty length
    // Y=0
    // Z=1,C=1
    // length=0
// -----------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------
string_copy_test1:
    ldy #0 //clear Y
    lda #1 //clear Z flag
    clc
    // Y=0
    // Z=0,C=0
    // string1 <> string3
    @c128lib_StringCopy(string1,string3,false)
    // Y = 0
    // Z=1,C=1
    // string1 == string3
// -----------------------------------------------------------------------------------------------------  
string_copy_test2:
    lda #<string4
    sta c128lib.String.ZP_TRG
    lda #>string4
    sta c128lib.String.ZP_TRG+1    

    ldy #0 //clear Y
    lda #1 //clear Z flag
    clc
    // Y=0
    // Z=0,C=0
    // string1 <> string4
    @c128lib_StringCopy(c128lib.String.ZP_SRC,c128lib.String.ZP_TRG,false)
    // Y = 0
    // Z=1,C=1
    // string1 == string4
// -----------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------
string_copyleft_test1:
    lda #$FF
    sta num_chars
    //num_chars = 255
    //string5 <> string6
    @c128lib_StringCopyLeft(string5,string6,num_chars,false)
    //num_chars = 255
    //string5 == string6
// -----------------------------------------------------------------------------------------------------  
string_copyleft_test2:
    lda #<string5
    sta c128lib.String.ZP_SRC
    lda #>string5
    sta c128lib.String.ZP_SRC+1    

    lda #<string7
    sta c128lib.String.ZP_TRG
    lda #>string7
    sta c128lib.String.ZP_TRG+1    

    //num_chars = 255
    //string5 <> string7
    @c128lib_StringCopyLeft(c128lib.String.ZP_SRC,c128lib.String.ZP_TRG,num_chars,false)
    //num_chars = 255
    //string5 == string7
// -----------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------
string_copyright_test1:
    lda #$FF
    sta length
    lda #6
    sta num_chars
    //string5 <> string8
    //length = 255
    //num_chars = 6
    @c128lib_StringCopyRight(string5,string8,length, num_chars,false)
    //string5 stays unchanged.
    //string8 = "PALERMO\0"
    //length = 255
    //num_chars = 6
// -----------------------------------------------------------------------------------------------------  
string_copyright_test2:
    lda #<string9
    sta c128lib.String.ZP_TRG
    lda #>string9
    sta c128lib.String.ZP_TRG+1  
    //string5 <> string9
    //length = 255
    //num_chars = 6
    @c128lib_StringCopyRight(c128lib.String.ZP_SRC,c128lib.String.ZP_TRG,length,num_chars,false)    
    //string5 stays unchanged.
    //string9 = "PALERMO\0"
    //length = 255
    //num_chars = 6
// -----------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------
string_copymid_test1:
    lda #252
    sta start_pos
    lda #255
    sta num_chars
    //string5 <> string10 
    //start_pos = 252
    //num_chars = 255
    @c128lib_StringCopyMid(string5,string10,start_pos,num_chars,false)
    //string5 stays unchanged
    //string10 = "LERM\0"
    //start_pos = 252
    //num_chars = 255
// -----------------------------------------------------------------------------------------------------
string_copymid_test2:
    lda #<string11
    sta c128lib.String.ZP_TRG
    lda #>string11
    sta c128lib.String.ZP_TRG+1  
    //string5 <> string11
    //start_pos = 252
    //num_chars = 255
    @c128lib_StringCopyMid(c128lib.String.ZP_SRC,c128lib.String.ZP_TRG,start_pos,num_chars,false)
    //string5 stays unchanged
    //string11 = "LERM\0"
    //start_pos = 252
    //num_chars = 255
// -----------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------
string_concat_test1:
    //length = 255
    // Make note of contents of $FA, $FB, $FC, $FD
    @c128lib_StringConcatenate(string12,string13,length,false)
    //length = 255 
    // Make note of contents of $FA, $FB, $FC, $FD and compare to before
// -----------------------------------------------------------------------------------------------------
string_concat_test2:
    lda #<string14
    sta c128lib.String.ZP_SRC
    lda #>string14
    sta c128lib.String.ZP_SRC+1

    lda #<string15
    sta c128lib.String.ZP_TRG
    lda #>string15
    sta c128lib.String.ZP_TRG+1

    //length = 255
    // Make note of contents of $FA, $FB, $FC, $FD
    @c128lib_StringConcatenate(c128lib.String.ZP_SRC,c128lib.String.ZP_TRG,length,false)
    //length = 255 
    // Make note of contents of $FA, $FB, $FC, $FD and compare to before

    jmp *  
